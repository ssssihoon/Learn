# RecommenderSystem

# 추천 시스템 프로젝트 진행 방법

1. 과제 정의
2. 가설 수립
3. 데이터 설계 / 수집 / 가공
4. 알고리즘 선정
5. 학습 / 파라미터 튜닝
6. 시스템 구현
7. 평가 및 개선

## 추천 시스템의 종류

- **입력 (데이터 입력)**
    - 사용자와 아이템의 콘텐츠 정보
    - 사용자와 아이템의 인터랙션 정보
- **프로세스 (추천 설계)**
    - 개요 추천 설계
    - 연관 아이템 설계
    - 개인화 설계
- **출력 (추천 결과 제시)**
    - 첫 페이지에 표시
    - 상품 구입 후 메일로 전송
    - 우편으로 쿠폰 발송

### 입력 (데이터 입력)

추천 시스템에 사용하는 데이터는 콘텐츠와 인터랙션 두 종류가 있다.

- 콘텐츠 정보
    - 나이, 성별, 주소 등 프로필 정보이다.
    - 콘텐츠 정보를 이용하는 추천을 **내용 기반 필터링**이라고 한다.
- 인터랙션 정보
    - 사용자가 서비스 안에서 행동한 이력 데이터를 말한다. 열람, 구입, 북마크, 평가 등
    - 인터랙션 정보를 사용하는 추천을 **협조 필터링**이라 부른다.

*콘텐츠 정보보다는 인터랙션 데이터가 실시간으로 업데이트 되기 때문에 인터랙션 데이터를 사용한 협조 필터링이 사용자의 기호를 더 반영하여 클릭이나 구입을 유도할 수 있는 추천 방법이 되는 경향이 있다.*

**신규 사용자나 신규 아이템 데이터가 적어 추천이 어려워지는 것 : 콜드 스타트 문제**

### 프로세스 (추천 설계)

- 개요 추천 (개인화 없음)
    - 모든 사용자에게 동일한 내용을 제시 (신규 아이템순, 낮은 가격순, 높은 인기순)
- 연관 아이템 추천
    - 각 아이템 사이의 유사도를 사용. 유사도 설계로 협조 필터링 방법이 있다.
        - → 프린터를 구입한 수에는 그에 대응하는 카트리지와 같은 소모품이 제시되면 좋겠다고 생각할 수 있다. 이를 고려한 연관 아이템 추천 구조를 설계하는 것이 중요
        - ***해리포터 문제 :*** 특정 시기에 많은 사람이 해리포터 서적을 다른 아이템과 함께 구입함에 따라 모든 추천 아이템이 해리포터가 추천되었음 주의 해야 함.
- 개인화 추천
    - 콘텐츠를 기반으로 하는 방법
        - 프로필 정보를 기반으로 그에 맞는 아이템 그룹을 설계 (구인 정보의 경우, 위치에서 가까운 정보를 필터링 해 추천)
    - 인터랙션 데이터를 활용하는 방법
        - 사용자의 과거 행동 이력으로부터 추천 아이템을 계산
            - 만약 전의 행동 이력을 그대로 추천해 주는 것은 비용이 적다. (리마인더 기능)
    - 콘텐츠, 인터랙션 모두 사용하는 방법
        - 사용자가 열람한 아이템과 비슷한 아이템 그룹을 연관 아이템 추천 구조로 추출해 이들을 메일로 보내기도 한다.

## 검색 시스템

|  | 검색 시스템 | 추천 시스템 |
| --- | --- | --- |
| 사용자가 미리 마음에 드는 아이템을 파악하고 있는가? | 파악하고 있는 경우가 많음 | 파악하고 있지 않은 경우가 많음 |
| 키워드(쿼리) 입력 | 입력 있음 | 입력 없음 |
| 연관 아이템 추천 방법 | 입력된 검색 키워드로 사용자 의도 추측 | 사용자 프로필이나 과거 행동으로 추측 |
| 사용자의 자세 | 능동적 | 수동적 |
| 개인화 | 개인화하지 않는 경우가 많지만 최근에는 개인화 서비스가 증가하고 있음 | 개인화하는 경우가 많음 |

# 추천 알고리즘 분류

- 추천 알고리즘
    - 내용 기반 필터링 : 제목, 저자, 장르와 같이 아이템의 내용을 나타내는 정보를 사용 ; 비슷한 아이템 추천 → 코미디 장르 A영화를 통해 코미디 장르인 B영화 추천
    - 협조 필터링 : 다른 사용자의 과거 행동 등을 통해 얻어진 경향을 활용해 추천 → a와 b가 같은 책을 구매한 이력이 있고, a가 소설책을 구매했다면 b에게 추천
        - 메모리 기반 방법 : 추천 시스템이 사용될 때까지 시스템에 사용자의 데이터를 축적하기만 하고 예측을 위한 계산은 수행하지 않음. 예측 시점에 계산을 수행해 예측, 시간이 걸림, 항상 최신데이터를 반영 가능
        - 모델 기반 방법 : 추천 시스템을 사용하기 전 미리 시스템 내 축적된 데이터의 규칙성을 학습한 모델을 만들어두고 예측 시 만들어진 모델과 추천을 제공하는 대상 사용자의 데이터만 사용해 계산을 수행, 시간이 안걸림, 업데이트 시 재학습으로 인한 비용이 있음

## 내용 기반 필터링

- 사용자가 어떤 내용의 아이템을 좋아하는가? → 사용자 프로필과 다양한 특징으로 유사도를 계산해 좋아할 만한 아이템을 사용자에게 추천

### 사용자 프로필 획득

- 간접 지정형
    - 사용자의 과거 행동 이력에 기반해 사용자 프로필을 작성, 사용자의 구입 이력의 선호를 통해 사용자 프로필을 만들 수 있다.
- 직접 지정형
    - 사용자에게 자신이 선호하는 아이템의 특징을 명시적으로 지정하도록 한다.

## 협조 필터링

- 복잡한 사용자의 기호를 표현할 수 있다, 높은 정확도
- 메모리 기반 방법
    - 사용자-사용자 메모리 기반 방법 : 추천받을 사용자와 선호도가 비슷한 사용자에 착안하여 아이템을 추천
    - 아이템-아이템 메모리 기반 방법 : 추천받을 사용자가 선호하는 아이템과 비슷한 아이템에 착안하여 추천

---

- 평갓값 : 사용자가 해당 아이템의 선호도 정도를 정량적으로 나타낸 것
- 평갓값 행렬 : 사용자 X 아이템의 행렬

<모델>

- 클러스터링 모델
- 회귀 모델
- 토픽 모델
- 행렬 분해 모델

### 콜드 스타트 문제 대응

- 협조 필터링은 데이터가 없기 때문에 초기에 추천 불가능
    - → 내용 기반 필터링의 경우 아이템 특징이나 사용자 프로필만 얻을 수 있다면 추천 가능 but 완벽 대응 불가능

# 추천시스템 알고리즘

| 알고리즘명 | 설명 | 예측 정확도 | 계산 속도 | 콜드 스타트 문제 대응 |
| --- | --- | --- | --- | --- |
| 무작위 추천 | 무작위로 아이템을 추천(베이스라인으로 주로 사용) | x | ⦾ | o |
| 통계 정보나 특정 규칙을 기반으로 추천(인기도 추천 등) | 베이스라인으로 자주 사용 | x | ⦾ | o |
| 연관 규칙 | 간단한 계산 방법이고 SQL로도 구현 가능 | o | o | x |
| 사용자-사용자 메모리 기반 방법 협조 필터링 | 위와 동일 | o | o | x |
| 회귀 모델 | 회귀 문제로서 추천 태스크를 정식화하여 다양한 머신러닝 방법을 적용 | o | o | x |
| SVD | 간단한 행렬 분해 방법 | ∆ | ∆ | ∆ |
| NMF | 비음수 제약을 추가한 행렬 분석 방법 | ∆ | ∆ | x |
| MF | 넷플릭스 프라이즈에서 좋은 성적을 거둔 행렬 분해 방법 | o | o | x |
| IMF | 암묵적 평갓값에 대응하는 행렬 분해 방법 | o | o | x |
| BPR | 암묵적 평갓값에 대응하여 순위를 고려한 행렬 분해 방법 | o | o | x |
| FM | 평갓값 외에도 아이템과 사용자의 정보를 가미할 수 있는 방법 | o | o | o |
| LDA(콘텐츠 기반) | 아이템의 콘텐츠 정보에 토픽 모델을 적용해 추천하는 방법 | ∆ | ∆ | o |
| LDA(협조 필터링) | 사용자의 행동 이력에 토픽 모델을 적용해 추천하는 방법 | o | ∆ | x |
| word2vec(콘텐츠 기반) | 아이템 콘텐츠 정보에 word2vec를 적용해 추천하는 방법 | ∆ | o | o |
| item3vec(협조 필터링) | 사용자의 행동 이력에 word2vec을 적용해 추천하는 방법 | o | o | x |
| 머신러닝 | 머신러닝 추천 방법 | o | ∆ | o |

# MovieLens

영화 평가 데이터셋
